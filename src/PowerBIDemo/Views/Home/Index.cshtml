@{
    ViewData["Title"] = "Home Page";
}
<div class="row">
    <div id="newCartItemDiv" class="col-md-4">
        <h4>You are about to buy:</h4>
        <h1 id="newCartItemH1"></h1>
    </div>
</div>

<div class="row">
    <div>
        <br />
        <div style="height:600px" id="reportContainer"></div>
    </div>
</div>

    <script language="javascript" type="text/javascript">

        var carthub = $.connection.cart;

        var embedConfiguration = {
            type: 'report',
            accessToken: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ2ZXIiOiIwLjIuMCIsImF1ZCI6Imh0dHBzOi8vYW5hbHlzaXMud2luZG93cy5uZXQvcG93ZXJiaS9hcGkiLCJpc3MiOiJQb3dlciBCSSBOb2RlIFNESyIsInR5cGUiOiJlbWJlZCIsIndjbiI6Im1ha3NoLXBiaS13cy1jb2xsIiwid2lkIjoiNzY2NThjMTctZWZhZi00ZTBjLTgxMjQtNGY3M2I4NGRmNzE5IiwicmlkIjoiODEwNjE1ODQtNWE2ZC00NjQ4LThlMDgtZTIzNTZhZmVmMjAxIiwibmJmIjoxNDkyMTUwNDUxLCJleHAiOjE0OTIxNTQwNTF9.5yz6-9lW95sqlirIOCrXFM5pl1kmD7IBJA3UvisFY30',
            id: '81061584-5a6d-4648-8e08-e2356afef201',
            embedUrl: 'https://embedded.powerbi.com/appTokenReportEmbed?reportId=81061584-5a6d-4648-8e08-e2356afef201'
        };

        var $reportContainer = $('#reportContainer');

        var userip;

        carthub.client.messageReceived = function (message) {

            write(message.NewCartItem, newCartItemH1, newCartItemDiv);

        };

        setInterval(repeatProcess, 1500);

        function repeatProcess() {
            loadPowerBI();
            getItem();
        };

        function getItem() {
            $.connection.hub.start().done(function () {
                carthub.server.connect(userip, $("#newCartItemH1").text());
                carthub.server.send();
            });

            
        };

        function loadPowerBI() {
            var report = powerbi.embed($reportContainer.get(0), embedConfiguration);
        };

        function write(message, textdiv, outerdiv) {
            textdiv.innerHTML = message;
            outerdiv.replaceChild(textdiv, textdiv);
        }
    </script>
